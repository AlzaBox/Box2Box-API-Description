{
  "openapi": "3.0.1",
  "info": {
    "title": "Box2BoxConnector",
    "description": "Connector between partners and Box2Box's ecosystem.",
    "contact": {
      "name": "Alza.cz a.s.",
      "url": "https://alza.cz",
      "email": "erp_konzole2@alza.cz"
    },
    "license": {
      "name": "All rights reserved"
    },
    "version": "1.0"
  },
  "paths": {
    "/api/v1/box": {
      "get": {
        "tags": [
          "Box"
        ],
        "summary": "Gets a box according to box's id. (Auth)",
        "description": "Sample request:\r\n\r\n    GET api/v1/box?boxId=1",
        "parameters": [
          {
            "name": "boxId",
            "in": "query",
            "description": "Box id.",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/BoxResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BoxResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/BoxResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        },
        "security": [
          {
            "OAuth2": [ ]
          },
          {
            "Bearer": [ ]
          }
        ]
      }
    },
    "/api/v1/boxes": {
      "get": {
        "tags": [
          "Box"
        ],
        "summary": "Get all boxes. (Auth)",
        "description": "Sample request:\r\n\r\n    GET api/v1/boxes",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/BoxResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BoxResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/BoxResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        },
        "security": [
          {
            "OAuth2": [ ]
          },
          {
            "Bearer": [ ]
          }
        ]
      }
    },
    "/api/v1/order": {
      "post": {
        "tags": [
          "Order"
        ],
        "summary": "Creates a order according to partner's input. (Auth)",
        "description": "Sample request:\r\n\r\n    POST api/v1/order\r\n    {    \r\n        \"partnerOrderId\": \"Order-123\",\r\n        \"subPartnerId\": \"SubPartner-123\",\r\n        \"recipientBoxId\": 123,\r\n        \"orderValue\": 500,\r\n        \"recipient\": {\r\n            \"fullName\": \"Jan Novák\",\r\n            \"phoneNumberPrefix\": \"+420\",\r\n            \"phoneNumber\": \"777666555\",\r\n            \"email\": \"jan.novak@example.cz\"\r\n        }\r\n        \"payment\": {\r\n            \"price\": 99,\r\n            \"variableSymbol\": \"123\",\r\n            \"currency\": \"CZK\",\r\n            \"refundBankNumber\": \"123456789/0100\"\r\n        }\r\n        \"package\": {\r\n            \"dimensions\": {\r\n                \"depth\": 15.6\r\n                \"height\": 12.3,\r\n                \"width\": 7.8\r\n            }\r\n            \"weight\": 2.5\r\n        }\r\n    }",
        "requestBody": {
          "description": "Partner's input.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateOrderBodyInput"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateOrderBodyInput"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/CreateOrderBodyInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/OrderResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrderResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrderResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        },
        "security": [
          {
            "OAuth2": [ ]
          },
          {
            "Bearer": [ ]
          }
        ]
      }
    },
    "/api/v1/order/{partnerOrderId}/label": {
      "get": {
        "tags": [
          "Order"
        ],
        "summary": "Gets the PDF label for a specific order and sub-partner (default if not filled in). (Auth)",
        "description": "Sample requests:\r\n\r\n    GET api/v1/order/Order-123/label\r\n    GET api/v1/order/Order-123/label?subPartnerId=SubPartner-123\r\n    \r\nBase64 string label deserialization example:\r\n\r\n    byte[] bytes = Convert.FromBase64String(base64String);\r\n    string filePath = Path.Combine(Environment.CurrentDirectory, \"label.pdf\");\r\n    File.WriteAllBytes(filePath, bytes);",
        "parameters": [
          {
            "name": "partnerOrderId",
            "in": "path",
            "description": "The partner's order identifier.",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "subPartnerId",
            "in": "query",
            "description": "(Optional) The sub-partner identifier. \r\nIf not provided the default sub-partner is used.",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/LabelResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LabelResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/LabelResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        },
        "security": [
          {
            "OAuth2": [ ]
          },
          {
            "Bearer": [ ]
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "Address": {
        "type": "object",
        "properties": {
          "streetWithNumber": {
            "type": "string",
            "description": "Street and number where box is placed.",
            "nullable": true
          },
          "city": {
            "type": "string",
            "description": "City where box is placed.",
            "nullable": true
          },
          "zip": {
            "type": "string",
            "description": "Zip code of location where box is placed.",
            "nullable": true
          },
          "countryShortCode": {
            "type": "string",
            "description": "Country where box is placed.",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "BoxResponse": {
        "type": "object",
        "properties": {
          "boxId": {
            "type": "integer",
            "description": "Identification of box.",
            "format": "int32"
          },
          "name": {
            "type": "string",
            "description": "Name of AlzaBox.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Description.",
            "nullable": true
          },
          "address": {
            "$ref": "#/components/schemas/Address"
          },
          "gps": {
            "$ref": "#/components/schemas/Gps"
          },
          "mainPhoto": {
            "type": "string",
            "description": "Main box photo.",
            "nullable": true
          },
          "openingHours": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OpeningHours"
            },
            "description": "Box opening hours.",
            "nullable": true
          },
          "isActive": {
            "type": "boolean",
            "description": "Whether the box is active."
          },
          "acceptsCardPayment": {
            "type": "boolean",
            "description": "Whether it is possible to pay by card."
          },
          "email": {
            "type": "string",
            "description": "Email contact.",
            "nullable": true
          },
          "phoneNumber": {
            "type": "string",
            "description": "Phone number contact.",
            "nullable": true
          },
          "type": {
            "type": "string",
            "description": "Info about AlzaBox placement.",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "CreateOrderBodyInput": {
        "required": [
          "orderValue",
          "package",
          "partnerOrderId",
          "recipient",
          "recipientBoxId"
        ],
        "type": "object",
        "properties": {
          "partnerOrderId": {
            "type": "string",
            "description": "Partner identification of the order.",
            "example": "Order-123"
          },
          "subPartnerId": {
            "type": "string",
            "description": "Identification of subpartner.",
            "nullable": true,
            "example": "SubPartner-123"
          },
          "recipientBoxId": {
            "type": "integer",
            "description": "Identification of AlzaBox partner wants to send the package to.",
            "format": "int32",
            "example": 123
          },
          "orderValue": {
            "type": "number",
            "description": "Value of the order.",
            "format": "double",
            "example": 500
          },
          "recipient": {
            "$ref": "#/components/schemas/RecipientInfo"
          },
          "payment": {
            "$ref": "#/components/schemas/PaymentInfo"
          },
          "package": {
            "$ref": "#/components/schemas/PackageInfo"
          }
        },
        "additionalProperties": false,
        "description": "Input for creating order."
      },
      "DayOfWeek": {
        "enum": [
          0,
          1,
          2,
          3,
          4,
          5,
          6
        ],
        "type": "integer",
        "format": "int32"
      },
      "Gps": {
        "type": "object",
        "properties": {
          "lat": {
            "type": "number",
            "description": "Geo location where box is placed.",
            "format": "double",
            "nullable": true
          },
          "lng": {
            "type": "number",
            "description": "Geo location where box is placed.",
            "format": "double",
            "nullable": true
          }
        },
        "additionalProperties": false
      },     
      "LabelResponse": {
        "type": "object",
        "properties": {
          "base64SerializedLabel": {
            "type": "string",
            "description": "Label serialized in Base64 string in PDF format.",
            "nullable": true
          }
        },
        "additionalProperties": false,
        "description": "Label of an order."
      },
      "OpeningHours": {
        "type": "object",
        "properties": {
          "day": {
            "$ref": "#/components/schemas/DayOfWeek"
          },
          "open": {
            "type": "string",
            "description": "Opening time.",
            "nullable": true
          },
          "close": {
            "type": "string",
            "description": "Closing time.",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "OrderResponse": {
        "required": [
          "orderValue",
          "package",
          "partnerOrderId",
          "recipient",
          "recipientBoxId"
        ],
        "type": "object",
        "properties": {
          "partnerOrderId": {
            "type": "string",
            "description": "Partner identification of the order.",
            "example": "Order-123"
          },
          "subPartnerId": {
            "type": "string",
            "description": "Identification of subpartner.",
            "nullable": true,
            "example": "SubPartner-123"
          },
          "recipientBoxId": {
            "type": "integer",
            "description": "Identification of AlzaBox partner wants to send the package to.",
            "format": "int32",
            "example": 123
          },
          "orderValue": {
            "type": "number",
            "description": "Value of the order.",
            "format": "double",
            "example": 500
          },
          "recipient": {
            "$ref": "#/components/schemas/RecipientInfo"
          },
          "payment": {
            "$ref": "#/components/schemas/PaymentInfo"
          },
          "package": {
            "$ref": "#/components/schemas/PackageInfo"
          },
          "senderPin": {
            "type": "string",
            "description": "Pin for sender to let the package in.",
            "nullable": true,
            "example": "A123456"
          },
          "state": {
            "type": "string",
            "description": "State of the order.",
            "nullable": true,
            "example": "New"
          }
        },
        "additionalProperties": false,
        "description": "General response for Order."
      },
      "PackageDimensionsInfo": {
        "required": [
          "depth",
          "height",
          "width"
        ],
        "type": "object",
        "properties": {
          "depth": {
            "type": "number",
            "description": "Depth of the package in cm.\r\nAllowed precision is 9 and scale 1.\r\nAllowed values are from 0.1 to 99_999_999.9 cm\r\nwith up to one digit allowed to the right of the decimal point.",
            "format": "double",
            "example": 15.6
          },
          "height": {
            "type": "number",
            "description": "Height of the package in cm.\r\nAllowed precision is 9 and scale 1.\r\nAllowed values are from 0.1 to 99_999_999.9 cm\r\nwith up to one digit allowed to the right of the decimal point.",
            "format": "double",
            "example": 12.3
          },
          "width": {
            "type": "number",
            "description": "Width of the package in cm.\r\nAllowed precision is 9 and scale 1.\r\nAllowed values are from 0.1 to 99_999_999.9 cm\r\nwith up to one digit allowed to the right of the decimal point.",
            "format": "double",
            "example": 7.8
          }
        },
        "additionalProperties": false,
        "description": "Package dimensions."
      },
      "PackageInfo": {
        "required": [
          "dimensions",
          "weight"
        ],
        "type": "object",
        "properties": {
          "dimensions": {
            "$ref": "#/components/schemas/PackageDimensionsInfo"
          },
          "weight": {
            "type": "number",
            "description": "Weight of the package in kg.\r\nAllowed precision is 9 and scale 3.\r\nAllowed values are from 0.001 to 999_999.999 kg\r\nwith up to three digits allowed to the right of the decimal point.",
            "format": "double",
            "example": 2.5
          }
        },
        "additionalProperties": false,
        "description": "Information about package."
      },
      "PaymentInfo": {
        "type": "object",
        "properties": {
          "price": {
            "type": "number",
            "description": "Price.",
            "format": "double",
            "nullable": true,
            "example": 99
          },
          "variableSymbol": {
            "type": "string",
            "description": "Variable symbol of payment.",
            "nullable": true,
            "example": "123"
          },
          "currency": {
            "type": "string",
            "description": "Currency of payment.",
            "nullable": true,
            "example": "CZK"
          },
          "refundBankNumber": {
            "type": "string",
            "description": "Bank number of account to refund.",
            "nullable": true,
            "example": "123456789/0100"
          }
        },
        "additionalProperties": false,
        "description": "Information about payment."
      },
      "ProblemDetails": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "nullable": true
          },
          "title": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "detail": {
            "type": "string",
            "nullable": true
          },
          "instance": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": { }
      },
      "RecipientInfo": {
        "required": [
          "fullName",
          "phoneNumber",
          "phoneNumberPrefix"
        ],
        "type": "object",
        "properties": {
          "fullName": {
            "type": "string",
            "description": "Full name of the recipient.",
            "example": "Jan Novák"
          },
          "phoneNumberPrefix": {
            "type": "string",
            "description": "Phone number prefix.",
            "example": "+420"
          },
          "phoneNumber": {
            "type": "string",
            "description": "Phone number.",
            "example": "777682598"
          },
          "email": {
            "type": "string",
            "description": "Email of the recipient.",
            "nullable": true,
            "example": "jan.novak@example.cz"
          }
        },
        "additionalProperties": false,
        "description": "Information about recipient."
      }
    },
    "securitySchemes": {
      "OAuth2": {
        "type": "oauth2",
        "description": "IMPORTANT NOTE: If you do not specify any scope in the authentication request\n                        then generated access token gets all scopes the specified client_id is authorized for.\n                        This behavior is by design by Duende.",
        "flows": {         
          "clientCredentials": {
            "tokenUrl": "https://identitymanagement.phx-test.alza.cz/connect/token",
            "scopes": {
              "konzole_access": "Konzole Access"            
            }
          }
        }
      }     
    }
  },
  "tags": [
    {
      "name": "Box",
      "description": "Controller for boxes management."
    },
    {
      "name": "Order",
      "description": "Controller for orders management."
    }
  ]
}
